{% extends "dormitory/layout.html" %} 
{% load markdown_tag %}

{% block body %}
<title>{{ dormitory.title }}</title>

<style>
    .p9 {
        font-family: 'Noto Sans Thai', sans-serif;
        font-size: 1.5em;
    }
    .p2 {
        font-family: 'Noto Sans Thai', sans-serif;
        font-size: 2em;
    }
    .p3 {
        font-family: "Prompt", sans-serif;
        font-size: 0.9em;
    }
    .p4 {
        font-family: "Prompt", sans-serif;
        font-size: 1.2em;
    }
    .p5 {
        font-family: "Prompt", sans-serif;
        font-size: 1.1em;
    }
    .p5:hover {
        color: #aa98e7;
    }
    img{
        display: block;
        margin-left: auto;
        margin-right: auto;
        width: 100%;
    }
    .h3:before,
    .h3:after {
        background-color: rgb(211, 211, 211);
        content: "";
        display: inline-block;
        height: 1px;
        position: relative;
        vertical-align: middle;
        width: 46%;
    }
    .h3:before {
        right: 0.5em;
        margin-left: 1%;
    }
    .h3:after {
        left: 0.5em;
        margin-right: -50%;
    }
    h1,h2,h3,h4,h5,h6 {
        font-family: 'Noto Sans Thai', sans-serif;
    }
    .line {
        height: 1px;
        width: 100%;
        background-color: #E0E0E0;
        margin-top: 10px;
    }
    .button5 {
        background-color: white;
        color: black;
        border: 2px solid white;
        padding: 2px 2px;
    }

    .button5:hover {
        background-color: #e2e2e2;
        color: rgb(0, 0, 0);
        border: 2px solid #e2e2e2;
    }
    .button6 {
        background-color: #8878c3;
        color: white;
        border: 2px solid #8878c3;
        padding: 7px 5em;
    }

    .button6:hover {
        background-color: #ccccff;
        color: rgb(0, 0, 0);
        border: 2px solid #ccccff;
    }
    .button7 {
        background-color: #8878c3;
        color: white;
        border: 2px solid #8878c3;
    }

    .button7:hover {
        background-color: #ccccff;
        color: rgb(0, 0, 0);
        border: 2px solid #ccccff;
    }
    *{
        margin: 0;
        padding: 0;
    }
    .rate {
        float: left;
        height: 46px;
        padding: 0 10px;
    }
    .rate:not(:checked) > input {
        position:fixed;
        top:-9999px;
    }
    .rate:not(:checked) > label {
        float:right;
        width:1.3em;
        overflow:hidden;
        white-space:nowrap;
        cursor:pointer;
        font-size:23px;
    }

    .rate > input:checked ~ label:before {
        content: 'üåù';

    }

    .rate:not(:checked) > label:hover:before
    {
        content: 'üåù';
    }
    .rate:not(:checked) > label:hover ~ label:before {
        content: 'üåù';

    }


    .rate > input:checked + label:hover,
    .rate > input:checked + label:hover ~ label,
    .rate > input:checked ~ label:hover,
    .rate > input:checked ~ label:hover ~ label,
    .rate > label:hover ~ input:checked ~ label:before {
        content: 'üåù';
    ;
    }

    #id_title {
        width :600px;
        height: 50px;
    }
    #id_desc {
        width :600px;
        height: 150px;
    }
    #id_content {
        width :600px;
        height: 300px;
    }


</style>

<script language="javascript">
    function confirm_delete_dorm()
{
    var answer = window.confirm("‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏•‡∏ö‡∏´‡∏≠‡∏û‡∏±‡∏Å");
    if(answer)
    {
        alert("‡∏•‡∏ö‡∏´‡∏≠‡∏û‡∏±‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
    }
    return answer;
}
function confirm_delete_review()
{
    var answer = window.confirm("‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏•‡∏ö‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡∏ß‡∏¥‡∏ß");
    if(answer)
    {
        alert("‡∏•‡∏ö‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à");
    }
    return answer;
}
</script>


<!-- content -->
<div style="margin-left: 25%; margin-right: 25%; margin-bottom: 13em; margin-top: 4em;">
    {% if check_update_dorm == 1 %}
        <form method="POST" action="{% url 'dormitory:update_dormitory' dormitory.id %}" enctype="multipart/form-data">
        
            {% csrf_token %}
        
            <div class="container">
                <input type="submit" value ="‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç" class="btn button1 p5" style="float: right;"></input>
                <p class="p9">‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏≠‡∏û‡∏±‡∏Å : </br> {{ form.title }}</p>
                <p class="p9">‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ : </br> {{ form.desc }}</p>
                <p class="p9">‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ : </br> {{ form.content }}</p>
            </div>
        </form>
        {{ form.media }}
        <br>
    {% else %}

        <h2><b class="p2">{{ dormitory.title }}</b></h2>
            <b class="p5">by {{ dormitory.author.username }}</b>
            <b class="p3" style="float: right;">{{dormitory.date}} &#9203;
            {% if request.user.username == dormitory.author.username %}
                <a href ="{% url 'dormitory:delete_dormitory' dormitory.id %}" style="float: right; text-decoration: none; margin-left: 0.5em; margin-top: -0.1em;" onclick="return confirm_delete_dorm()"><b class="p5">&#128680; ‡∏•‡∏ö</b></a>
                <a href = "{% url 'dormitory:update_dormitory' dormitory.id %}" style="float: right; text-decoration: none; margin-left: 0.5em; margin-top: -0.1em;"><b class="p5">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</b></a>
            {% endif %}
            </b>
            <br>
            <br>
            <b class="p4">{{dormitory.content | convert_markdown | safe }}</b>

            <br>
            <div style="float: right;">
                <a href="#‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏£‡∏µ‡∏ß‡∏¥‡∏ß"><button class="button button5"><b class="p4">&#128073; ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏£‡∏µ‡∏ß‡∏¥‡∏ß</b></button></a>
                <!-- Search for thread-->
                <form  action="{% url 'thread:index' %}" method="POST" style="float: right;">
                    {% csrf_token %}
                    <input class="form-control" type="hidden" name="search" value="{{dormitory.title}}">
                    <button class="button button5" type="submit" style="margin-left: 1em;"><b class="p4"> &#128270; ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Å‡∏£‡∏∞‡∏ó‡∏π‡πâ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á</b></button>
                </form>
            </div>
            <br>
            <br>
            <br>
    {% endif %}
    {% if check_update_dorm != 1 %}
            <!-- review -->
            <h3 class="p3 h3">&#128172;<b> ‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡∏ß‡∏¥‡∏ß</b></h3>
            {% for review in dormitory.reviews.all %}
            
            {% if check_update_review == 1 and review.id == review_id%}
                <form method="POST" action="{% url 'dormitory:update_review' review.id %}" enctype="multipart/form-data">
                    {% csrf_token %}

                    <img class="avatar" src="/static/images/avatar.png" style="float:left; margin-right: 1em; margin-top: 0.5em; width: 3em; height: 3em;">
                    <b class="p3" style="margin-left: 0.5em;">{{review.author}} </b>
                    <br>
                        {% csrf_token %}
                        <div class="rate ">
                            <b class="p3">rating:</b>
                            <input name="stars" type="radio" id="star5" name="rate" value="5" />
                            <label for="star5" title="text">üåö</label>
                            <input name="stars" type="radio" id="star4" name="rate" value="4" />
                            <label for="star4" title="text">üåö</label>
                            <input name="stars" type="radio" id="star3" name="rate" value="3" />
                            <label for="star3" title="text">üåö</label>
                            <input name="stars" type="radio" id="star2" name="rate" value="2" />
                            <label for="star2" title="text">üåö</label>
                            <input name="stars" type="radio" id="star1" name="rate" value="1" />
                            <label for="star1" title="text">üåö</label>
                        </div>
                        
                        <textarea type="text" name="content" class="form-control" maxlength="500"required>{{review.content}}</textarea>
                        <br>
        
                        <input type="submit" value ="‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô" class="btn button6 p3"></input>

                </form>
                {{ form.media }}
                <br>

            {% else %}
                <img class="avatar" src="/static/images/avatar.png" style="float:left; margin-right: 1em; margin-top: 0.5em; width: 3em; height: 3em;">
                <b class="p3" style="margin-left: 0.5em;" id="{{review.id}}">{{review.author}} </b>
                <br>
                {% if review.stars == 1 %}
                <span style="font-size: 1.5em;"> &#127773;&#127770;&#127770;&#127770;&#127770;</span>
                {% elif review.stars == 2 %}
                    <span style="font-size: 1.5em;"> &#127773;&#127773;&#127770;&#127770;&#127770;</span>
                {% elif review.stars == 3 %}
                    <span style="font-size: 1.5em;"> &#127773;&#127773;&#127773;&#127770;&#127770;</span>
                {% elif review.stars == 4 %}
                    <span style="font-size: 1.5em;"> &#127773;&#127773;&#127773;&#127773;&#127770;</span>
                {% elif review.stars == 5 %}
                <span style="font-size: 1.5em;"> &#127773;&#127773;&#127773;&#127773;&#127773;</span>
                {% endif %}
                
                <br>
                
                <br>
                <b class="p3" style="float: right; margin-top: -5.5em;" >{{review.date}} &#9203;
                    {% if request.user.username == review.author.username %}
                        <a href ="{% url 'dormitory:delete_review' review.id %}" onclick="return confirm_delete_review()" style="float: right; text-decoration: none; margin-left: 0.5em; margin-top: -0.13em;"><b class="p5">&#128680; ‡∏•‡∏ö</b></a>
                        <a href ="{% url 'dormitory:update_review' review.id %}" style="float: right; text-decoration: none; margin-left: 0.5em; margin-top: -0.08em;"><b class="p5">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</b></a>
                    {% endif %}
                </b>
                
                <h4 >{{review.content | convert_markdown | safe }}</h4>
            
                <div style="float: right; margin-top: -2em; ">
                    <a href="{% url 'dormitory:report_review' review.id %}" class="button button5" role="button" aria-pressed="true">&#128681; <b class="p3">report</b></a>
                </div>
                <br>

                <div class="line"></div>
                <br>
            {% endif %}
            {% endfor %}
            {% if check_update_review != 1 %}
            {% if request.user.is_authenticated %}
            <!-- form -->
            <form method="POST" action="{% url 'dormitory:review_dormitory' dormitory.id%}" enctype="multipart/form-data" id=‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏£‡∏µ‡∏ß‡∏¥‡∏ß>
                {% csrf_token %}
                <b class="p4">Rating: </p>
                <div class="rate">
                    <input name="stars" type="radio" id="star5" name="rate" value="5" />
                    <label for="star5" title="text">üåö</label>
                    <input name="stars" type="radio" id="star4" name="rate" value="4" />
                    <label for="star4" title="text">üåö</label>
                    <input name="stars" type="radio" id="star3" name="rate" value="3" />
                    <label for="star3" title="text">üåö</label>
                    <input name="stars" type="radio" id="star2" name="rate" value="2" />
                    <label for="star2" title="text">üåö</label>
                    <input name="stars" type="radio" id="star1" name="rate" value="1" />
                    <label for="star1" title="text">üåö</label>
                  </div>
                <textarea type="text" name="content" class="form-control" maxlength="500" placeholder="‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏Å‡∏£‡∏∞‡∏ó‡∏π‡πâ" required></textarea>
                <br>

                <input type="submit" value ="‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô" class="btn button6 p3"></input>
            </form>
            {% else %}
            <a href="#login" style="text-decoration: none;"><h3 id=‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏£‡∏µ‡∏ß‡∏¥‡∏ß style="text-align: center;">&#9997; ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤ Login ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏£‡∏µ‡∏ß‡∏¥‡∏ß &#10071;</h3></a>
            {% endif %}
            {% endif %}
    {% endif %}

</div>


{% endblock %}

